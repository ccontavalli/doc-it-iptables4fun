<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.69">
 <TITLE>IPtables for Fun -- Implementare un firewall in linux: Modifiche on the fly - iptables da riga di comando: Manipolare le catene</TITLE>
 <LINK HREF="iptables4fun-35.html" REL=next>
 <LINK HREF="iptables4fun-33.html" REL=previous>
 <LINK HREF="iptables4fun.html#toc11" REL=contents>
</HEAD>
<BODY>
<A HREF="iptables4fun-35.html">Avanti</A>
<A HREF="iptables4fun-33.html">Indietro</A>
<A HREF="iptables4fun.html#toc11">Indice</A>
<HR>
<H2>11.1 <A HREF="iptables4fun.html#toc11.1">Manipolare le catene</A></H2>

<P>Gi&agrave; conosciamo i parametri:
<UL>
<LI><I>-N</I> -- per creare nuove catene</LI>
<LI><I>-X</I> -- per eliminare una catena (tutte, se non viene specificato un argomento)</LI>
<LI><I>-F</I> -- per eliminare tutte le regole di una catena (tutte, se non viene specificato
un argomento)</LI>
<LI><I>-A</I> -- per aggiungere regole alle catene</LI>
<LI><I>-P</I> -- per impostare le politiche</LI>
</UL>

In pi&ugrave;, vi possono tornare utili i comandi
<UL>
<LI><I>-I</I> -- per inserire una nuova regola
in una determinata posizione di una catena</LI>
<LI><I>-R</I> -- per sostituire una regola con un'altra</LI>
<LI><I>-D</I> -- per rimuovere una regola</LI>
</UL>

Cerchiamo per&ograve; di vedere questi parametri nella pratica. Ipotizzando
di avere una situazione come quella mostrata sopra con 
``iptables -nL'', immaginiamo di voler inserire una regola 
dopo quella relativa ad ssh (catena di INPUT, porta 22, riga 2) per consentire
l'accesso ad un web server installato sul mio portatile.
In questo caso, potremmo dare un comando come
<BLOCKQUOTE><CODE>
<PRE>
iptables -I INPUT 3 -p tcp --dport 80 -j ACCEPT
</PRE>
</CODE></BLOCKQUOTE>

Il 3 indica che questa regola deve essere inserita nella
terza riga, spostando tutte le altre righe pi&ugrave; in basso.
Dopo questo comando, ``iptables -nL INPUT'' mostrerebbe qualcosa come
<BLOCKQUOTE><CODE>
<PRE>
Chain INPUT (policy DROP)
target     prot opt source               destination         
ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0          
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0          tcp dpt:22 
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0          tcp dpt:80 
ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0          state RELATED,ESTABLISHED 
REJECT     tcp  --  0.0.0.0/0            0.0.0.0/0          reject-with tcp-reset 
</PRE>
</CODE></BLOCKQUOTE>

proprio come volevamo. Immaginiamo ora di spostare il web server sulla porta 443,
e di voler rimpiazzare la regola appena inserita con qualcosa come ``-p tcp --dport 443
-j ACCEPT''. In questo caso sarebbe sufficiente utilizzare
<BLOCKQUOTE><CODE>
<PRE>
iptables -R INPUT 3 -p tcp --dport 443 -j ACCEPT
</PRE>
</CODE></BLOCKQUOTE>

per ottenere qualcosa come
<BLOCKQUOTE><CODE>
<PRE>
Chain INPUT (policy DROP)
target     prot opt source               destination         
ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0          
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0          tcp dpt:22 
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0          tcp dpt:443 
ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0          state RELATED,ESTABLISHED 
REJECT     tcp  --  0.0.0.0/0            0.0.0.0/0          reject-with tcp-reset 
</PRE>
</CODE></BLOCKQUOTE>

Infine, per rimuovere la regola, basterebbe qualcosa come 
<BLOCKQUOTE><CODE>
<PRE>
iptables -D INPUT 3
</PRE>
</CODE></BLOCKQUOTE>

Se siete meno pigri di me, potete utilizzare anche
<BLOCKQUOTE><CODE>
<PRE>
iptables -D INPUT -p tcp --dport 443 -j ACCEPT
</PRE>
</CODE></BLOCKQUOTE>

che porterebbe esattamente allo stesso risultato.</P>

<HR>
<A HREF="iptables4fun-35.html">Avanti</A>
<A HREF="iptables4fun-33.html">Indietro</A>
<A HREF="iptables4fun.html#toc11">Indice</A>
</BODY>
</HTML>
